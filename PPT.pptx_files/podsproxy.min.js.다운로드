function _array_like_to_array(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _array_with_holes(e){if(Array.isArray(e))return e}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function asyncGeneratorStep(e,r,t,n,o,s,i){try{var a=e[s](i),u=a.value}catch(e){return void t(e)}a.done?r(u):Promise.resolve(u).then(n,o)}function _async_to_generator(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var s=e.apply(r,t);function i(e){asyncGeneratorStep(s,n,o,i,a,"next",e)}function a(e){asyncGeneratorStep(s,n,o,i,a,"throw",e)}i(void 0)}))}}function _class_call_check(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _create_class(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function _define_property(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _instanceof(e,r){return null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?!!r[Symbol.hasInstance](e):e instanceof r}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterable_to_array_limit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,s=[],i=!0,a=!1;try{for(t=t.call(e);!(i=(n=t.next()).done)&&(s.push(n.value),!r||s.length!==r);i=!0);}catch(e){a=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(a)throw o}}return s}}function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){_define_property(e,r,t[r])}))}return e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _object_spread_props(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})),e}function _sliced_to_array(e,r){return _array_with_holes(e)||_iterable_to_array_limit(e,r)||_unsupported_iterable_to_array(e,r)||_non_iterable_rest()}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,r){if(e){if("string"==typeof e)return _array_like_to_array(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_array_like_to_array(e,r):void 0}}function _ts_generator(e,r){var t,n,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=r.call(e,i)}catch(e){s=[6,e],n=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}!function(e,r){"object"===("undefined"==typeof exports?"undefined":_type_of(exports))&&"object"===("undefined"==typeof module?"undefined":_type_of(module))?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"===("undefined"==typeof exports?"undefined":_type_of(exports))?exports.PodsProxy=r():e.PodsProxy=r()}(globalThis,(function(){return function(){"use strict";var e={227:function(e){var r,t="object"===("undefined"==typeof Reflect?"undefined":_type_of(Reflect))?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,r,t){return Function.prototype.apply.call(e,r,t)};r=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,r){return new Promise((function(t,n){function o(t){e.removeListener(r,s),n(t)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",o),t([].slice.call(arguments))}_(e,r,s,{once:!0}),"error"!==r&&function(e,r,t){"function"==typeof e.on&&_(e,"error",r,{once:!0})}(e,o)}))},s.EventEmitter=s,s.prototype.t=void 0,s.prototype.i=0,s.prototype.u=void 0;var i=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+(void 0===e?"undefined":_type_of(e)))}function u(e){return void 0===e.u?s.defaultMaxListeners:e.u}function c(e,r,t,n){var o,s,i,c;if(a(t),void 0===(s=e.t)?(s=e.t=Object.create(null),e.i=0):(void 0!==s.newListener&&(e.emit("newListener",r,t.listener?t.listener:t),s=e.t),i=s[r]),void 0===i)i=s[r]=t,++e.i;else if("function"==typeof i?i=s[r]=n?[t,i]:[i,t]:n?i.unshift(t):i.push(t),(o=u(e))>0&&i.length>o&&!i.warned){i.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=r,l.count=i.length,c=l,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,r,t){var n={fired:!1,wrapFn:void 0,target:e,type:r,listener:t},o=l.bind(n);return o.listener=t,n.wrapFn=o,o}function f(e,r,t){var n=e.t;if(void 0===n)return[];var o=n[r];return void 0===o?[]:"function"==typeof o?t?[o.listener||o]:[o]:t?function(e){for(var r=new Array(e.length),t=0;t<r.length;++t)r[t]=e[t].listener||e[t];return r}(o):y(o,o.length)}function p(e){var r=this.t;if(void 0!==r){var t=r[e];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function y(e,r){for(var t=new Array(r),n=0;n<r;++n)t[n]=e[n];return t}function _(e,r,t,n){if("function"==typeof e.on)n.once?e.once(r,t):e.on(r,t);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+(void 0===e?"undefined":_type_of(e)));e.addEventListener(r,(function o(s){n.once&&e.removeEventListener(r,o),t(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),s.init=function(){void 0!==this.t&&this.t!==Object.getPrototypeOf(this).t||(this.t=Object.create(null),this.i=0),this.u=this.u||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this.u=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var r=[],t=1;t<arguments.length;t++)r.push(arguments[t]);var o="error"===e,s=this.t;if(void 0!==s)o=o&&void 0===s.error;else if(!o)return!1;if(o){var i;if(r.length>0&&(i=r[0]),_instanceof(i,Error))throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var u=s[e];if(void 0===u)return!1;if("function"==typeof u)n(u,this,r);else{var c=u.length,l=y(u,c);for(t=0;t<c;++t)n(l[t],this,r)}return!0},s.prototype.addListener=function(e,r){return c(this,e,r,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,r){return c(this,e,r,!0)},s.prototype.once=function(e,r){return a(r),this.on(e,d(this,e,r)),this},s.prototype.prependOnceListener=function(e,r){return a(r),this.prependListener(e,d(this,e,r)),this},s.prototype.removeListener=function(e,r){var t,n,o,s,i;if(a(r),void 0===(n=this.t))return this;if(void 0===(t=n[e]))return this;if(t===r||t.listener===r)0==--this.i?this.t=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,t.listener||r));else if("function"!=typeof t){for(o=-1,s=t.length-1;s>=0;s--)if(t[s]===r||t[s].listener===r){i=t[s].listener,o=s;break}if(o<0)return this;0===o?t.shift():function(e,r){for(;r+1<e.length;r++)e[r]=e[r+1];e.pop()}(t,o),1===t.length&&(n[e]=t[0]),void 0!==n.removeListener&&this.emit("removeListener",e,i||r)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var r,t,n;if(void 0===(t=this.t))return this;if(void 0===t.removeListener)return 0===arguments.length?(this.t=Object.create(null),this.i=0):void 0!==t[e]&&(0==--this.i?this.t=Object.create(null):delete t[e]),this;if(0===arguments.length){var o,s=Object.keys(t);for(n=0;n<s.length;++n)"removeListener"!==(o=s[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this.t=Object.create(null),this.i=0,this}if("function"==typeof(r=t[e]))this.removeListener(e,r);else if(void 0!==r)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,r){return"function"==typeof e.listenerCount?e.listenerCount(r):p.call(e,r)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this.i>0?r(this.t):[]}},37:function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ChangeGate=void 0;var t=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();r.ChangeGate=t},276:function(e,r){Object.defineProperty(r,"__esModule",{value:!0})},176:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var n=t(533);n.__exportStar(t(276),r),n.__exportStar(t(37),r)},533:function(e,r,t){t.r(r),t.d(r,{__addDisposableResource:function(){return j},__assign:function(){return s},__asyncDelegator:function(){return P},__asyncGenerator:function(){return C},__asyncValues:function(){return E},__await:function(){return b},__awaiter:function(){return y},__classPrivateFieldGet:function(){return k},__classPrivateFieldIn:function(){return R},__classPrivateFieldSet:function(){return M},__createBinding:function(){return h},__decorate:function(){return a},__disposeResources:function(){return W},__esDecorate:function(){return c},__exportStar:function(){return v},__extends:function(){return o},__generator:function(){return _},__importDefault:function(){return T},__importStar:function(){return A},__makeTemplateObject:function(){return x},__metadata:function(){return p},__param:function(){return u},__propKey:function(){return d},__read:function(){return g},__rest:function(){return i},__runInitializers:function(){return l},__setFunctionName:function(){return f},__spread:function(){return S},__spreadArray:function(){return w},__spreadArrays:function(){return I},__values:function(){return m},default:function(){return F}});var n=function(e,r){return n=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])},n(e,r)};function o(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var s=function(){return s=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},s.apply(this,arguments)};function i(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t}function a(e,r,t,n){var o,s=arguments.length,i=s<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"===("undefined"==typeof Reflect?"undefined":_type_of(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,t,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(r,t,i):o(r,t))||i);return s>3&&i&&Object.defineProperty(r,t,i),i}function u(e,r){return function(t,n){r(t,n,e)}}function c(e,r,t,n,o,s){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,u=n.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!r&&e?n.static?e:e.prototype:null,d=r||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),f=!1,p=t.length-1;p>=0;p--){var y={};for(var _ in n)y[_]="access"===_?{}:n[_];for(var _ in n.access)y.access[_]=n.access[_];y.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");s.push(i(e||null))};var h=(0,t[p])("accessor"===u?{get:d.get,set:d.set}:d[c],y);if("accessor"===u){if(void 0===h)continue;if(null===h||"object"!==(void 0===h?"undefined":_type_of(h)))throw new TypeError("Object expected");(a=i(h.get))&&(d.get=a),(a=i(h.set))&&(d.set=a),(a=i(h.init))&&o.unshift(a)}else(a=i(h))&&("field"===u?o.unshift(a):d[c]=a)}l&&Object.defineProperty(l,n.name,d),f=!0}function l(e,r,t){for(var n=arguments.length>2,o=0;o<r.length;o++)t=n?r[o].call(e,t):r[o].call(e);return n?t:void 0}function d(e){return"symbol"===(void 0===e?"undefined":_type_of(e))?e:"".concat(e)}function f(e,r,t){return"symbol"===(void 0===r?"undefined":_type_of(r))&&(r=r.description?"[".concat(r.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:t?"".concat(t," ",r):r})}function p(e,r){if("object"===("undefined"==typeof Reflect?"undefined":_type_of(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)}function y(e,r,t,n){return new(t||(t=Promise))((function(o,s){function i(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,_instanceof(r,t)?r:new t((function(e){e(r)}))).then(i,a)}u((n=n.apply(e,r||[])).next())}))}function _(e,r){var t,n,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var h=Object.create?function(e,r,t,n){void 0===n&&(n=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&!("get"in o?!r.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,o)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]};function v(e,r){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||h(r,e,t)}function m(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,o,s=t.call(e),i=[];try{for(;(void 0===r||r-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(t=s.return)&&t.call(s)}finally{if(o)throw o.error}}return i}function S(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(g(arguments[r]));return e}function I(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),o=0;for(r=0;r<t;r++)for(var s=arguments[r],i=0,a=s.length;i<a;i++,o++)n[o]=s[i];return n}function w(e,r,t){if(t||2===arguments.length)for(var n,o=0,s=r.length;o<s;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return e.concat(n||Array.prototype.slice.call(r))}function b(e){return _instanceof(this,b)?(this.v=e,this):new b(e)}function C(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=t.apply(e,r||[]),s=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(r){return new Promise((function(t,n){s.push([e,r,t,n])>1||a(e,r)}))})}function a(e,r){try{_instanceof((t=o[e](r)).value,b)?Promise.resolve(t.value.v).then(u,c):l(s[0][2],t)}catch(e){l(s[0][3],e)}var t}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,r){e(r),s.shift(),s.length&&a(s[0][0],s[0][1])}}function P(e){var r,t;return r={},n("next"),n("throw",(function(e){throw e})),n("return"),r[Symbol.iterator]=function(){return this},r;function n(n,o){r[n]=e[n]?function(r){return(t=!t)?{value:b(e[n](r)),done:!1}:o?o(r):r}:o}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,t=e[Symbol.asyncIterator];return t?t.call(e):(e=m(e),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(t){r[t]=e[t]&&function(r){return new Promise((function(n,o){!function(e,r,t,n){Promise.resolve(n).then((function(r){e({value:r,done:t})}),r)}(n,o,(r=e[t](r)).done,r.value)}))}}}function x(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e}var O=Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r};function A(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&h(r,e,t);return O(r,e),r}function T(e){return e&&e.__esModule?e:{default:e}}function k(e,r,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof r?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(e):n?n.value:r.get(e)}function M(e,r,t,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof r?e!==r||!o:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,t):o?o.value=t:r.set(e,t),t}function R(e,r){if(null===r||"object"!==(void 0===r?"undefined":_type_of(r))&&"function"!=typeof r)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?r===e:e.has(r)}function j(e,r,t){if(null!=r){if("object"!==(void 0===r?"undefined":_type_of(r))&&"function"!=typeof r)throw new TypeError("Object expected.");var n;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=r[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=r[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:r,dispose:n,async:t})}else t&&e.stack.push({async:!0});return r}var N="function"==typeof SuppressedError?SuppressedError:function(e,r,t){var n=new Error(t);return n.name="SuppressedError",n.error=e,n.suppressed=r,n};function W(e){function r(r){e.error=e.hasError?new N(r,e.error,"An error was suppressed during disposal."):r,e.hasError=!0}return function t(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(t,(function(e){return r(e),t()}))}catch(e){r(e)}}if(e.hasError)throw e.error}()}var F={__extends:o,__assign:s,__rest:i,__decorate:a,__param:u,__metadata:p,__awaiter:y,__generator:_,__createBinding:h,__exportStar:v,__values:m,__read:g,__spread:S,__spreadArrays:I,__spreadArray:w,__await:b,__asyncGenerator:C,__asyncDelegator:P,__asyncValues:E,__makeTemplateObject:x,__importStar:A,__importDefault:T,__classPrivateFieldGet:k,__classPrivateFieldSet:M,__classPrivateFieldIn:R,__addDisposableResource:j,__disposeResources:W}}},r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var s=r[n]={exports:{}};return e[n](s,s.exports,t),s.exports}t.d=function(e,r){for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n,o,s={};t.r(s),t.d(s,{ClientColorSettings:function(){return i},ErrorCategory:function(){return l},ErrorCode:function(){return c},GetRequestItemIds:function(){return d},ItemType:function(){return f},PodsProxy:function(){return C},PodsProxyConstants:function(){return u},PodsProxyRequestStageType:function(){return o},PodsProxyRequestType:function(){return n},SlideImageAppendOption:function(){return a},exposed:function(){return w},setupGlobals_PodsProxy:function(){return b}}),function(e){e.getPresInfoAsync="getPresInfoAsync",e.getItemsPresInfoAndSlideInfoAsync="getItemsPresInfoAndSlideInfoAsync",e.getItemsSlideInfosAsync="getItemsSlideInfosAsync",e.getSlideInfosAsync="getSlideInfosAsync"}(n||(n={})),function(e){e.GetItemsCall="GetItemsCall",e.DownloadResponseStream="DownloadResponseStream",e.ParseMultipartResponse="ParseMultipartResponse"}(o||(o={}));var i,a,u=function e(){_class_call_check(this,e)};u.unknown="unknown",u.ErrorCode="ErrorCode",u.ErrorCategory="ErrorCategory",u.errorCategory="errorCategory",u.errorCode="errorCode",u.IsIntentional="IsIntentional",u.isIntentional="isIntentional",u.XCorrelationId="X-CorrelationId",u.ContentType="Content-Type",u.ContentLength="Content-Length",u.ContenEncoding="Content-Encoding",u.TransferEncoding="Transfer-Encoding",u.XusedOutputCache="X-usedOutputCache",u.Xnewsnapurl="x-newsnapurl",u.ContentDisposition="Content-Disposition",u.CallerCorrelationId="CallerCorrelationId",u.action="action",u.parser="parser",u.server="server",u.callId="callId",u.dateHeader="x-ms-date",u.clientTimeoutHeader="x-ms-client-timeout",u.clientRequestIdHeader="x-ms-client-request-id",u.newSnapUrlHeader="x-newsnapurl",u.correlationId="correlationId",u.firstResponseCheck="firstResponseCheck",u.fetchBoundary="fetchBoundary",u.downloadResponse="downloadResponse",u.parserCallback="parserCallback",u.createResponse="createResponse",u.contentLength="contentLength",u.usedOutputCache="usedOutputCache",u.itemUsedOutputCacheMap="itemUsedOutputCacheMap",u.podsProxyCallSuceeded="podsProxyCallSuceeded",u.PriorityHint="PriorityHint",u.RequestInfo="RequestInfo",u.ResponseHeaders="ResponseHeaders",u.IsBootRequest="IsBootRequest",u.XErrorCode="X-ErrorCode",function(e){e.None="None",e.BlackColorTheme="#FFFFFF_#000000_#FFFF00"}(i||(i={})),function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial",e[e.Embed=3]="Embed"}(a||(a={}));var c,l,d=function e(){_class_call_check(this,e)};d.PresInfoMetaData="presinfo/metadata",d.PresinfoslimSlideOrder="presinfo/slimSlideOrder",d.slideInfoIndex="pres/sldIdx",d.slideInfoSid="pres/sldSid",d.slideNotesIndex="pres/NotesSldIdx",d.slideNotesSid="pres/NotesSldSid",d.slideCommentsIndex="pres/CommentsSldIdx",d.slideCommentsSid="pres/CommentsSldSid",d.slideMetadataIndex="pres/SlideMetadatasldIdx",d.slideMetadataSid="pres/SlideMetadataSldSid",d.slideAccessibilityModelIndex="pres/SlideAccessibilityModelSldIdx",d.slideAccessibilityModelSid="pres/SlideAccessibilityModelSldSid",function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.ErrorRESERVEDItemFailed="ErrorRESERVEDItemFailed",e.ErrorDownloadResponseStreamTimeout="ErrorDownloadResponseStreamTimeout",e.ErrorRequestFailed="ErrorRequestFailed",e.ErrorRequestFailedServiceUnavailable="ErrorRequestFailedServiceUnavailable",e.ErrorRequestFailedBadGateway="ErrorRequestFailedBadGateway",e.ErrorRequestFailedGatewayTimeout="ErrorRequestFailedGatewayTimeout",e.ErrorRequestFailedServerNotFound="ErrorRequestFailedServerNotFound",e.ErrorContentDispositionHeaderNotValid="ErrorContentDispositionHeaderNotValid",e.ErrorItemNameNotValid="ErrorItemNameNotValid",e.ErrorResponseNotValid="ErrorResponseNotValid",e.ErrorCannotParseResponse="ErrorCannotParseResponse",e.ErrorRequestTimeout="ErrorRequestTimeout",e.ErrorFailedToFetch="ErrorFailedToFetch",e.ErrorRequestCanceled="ErrorRequestCanceled",e.ErrorRequestAbort="ErrorRequestAbort",e.ErrorConnectionLost="ErrorConnectionLost",e.ErrorSoftwareConnectionAbort="ErrorSoftwareConnectionAbort",e.ErrorFailedToDownloadFile="ErrorFailedToDownloadFile",e.ErrorFileDownloadNetworkError="ErrorFileDownloadNetworkError",e.ErrorFileDownloadResourceInconsistent="ErrorFileDownloadResourceInconsistent",e.ErrorResourceInconsistentResnaptimeout="ErrorResourceInconsistentResnaptimeout",e.ErrorResourceInconsistentResnapNotStarted="ErrorResourceInconsistentResnapNotStarted",e.ErrorResourceInconsistentResnapUrlMissing="ErrorResourceInconsistentResnapUrlMissing",e.ServerErrorFileDownloadResourceInconsistent="ServerErrorFileDownloadResourceInconsistent",e.ServerErrorResourceInconsistentResnaptimeout="ServerErrorResourceInconsistentResnaptimeout",e.ServerErrorResourceInconsistentResnapNotStarted="ServerErrorResourceInconsistentResnapNotStarted",e.ServerErrorResourceInconsistentResnapUrlMissing="ServerErrorResourceInconsistentResnapUrlMissing"}(c||(c={})),function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.BadRequest="BadRequest",e.Fatal="Fatal",e.NotSupported="NotSupported",e.Transient="Transient"}(l||(l={}));var f=function e(){_class_call_check(this,e)};f.JsonType="application/json",f.ImagePng="image/png",f.ImageJpg="image/jpg",f.PlainTextType="text/plain";var p,y,_=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"processMultipartResponse",value:function(e,r,t){var n=this;return _async_to_generator((function(){var o,s;return _ts_generator(this,(function(i){if(null==e)throw"multipartContentBuffer is empty";try{o=new TextDecoder("utf-8").decode(e),n.parseMultipart(o,r).forEach((function(e){var r=n.parseResponsePart(e);t(r)}))}catch(e){s={Err:new Error(e)},t(s)}return[2]}))}))()}},{key:"fetchBoundary",value:function(e){var r=e.split("boundary=");if(2===r.length)return r[1];throw"No Boundary"}},{key:"processMultipartBinaryResponse",value:function(e,r,t){var n=this;return _async_to_generator((function(){var o,s,i,a,u,c,l,d,f,p,y,_,h,v,m,g,S,I,w,b,C,P,E,x,O;return _ts_generator(this,(function(A){switch(A.label){case 0:if(!e)throw"multipartContentBufferOrStream is empty";o="",s=void 0,i=0,a=[],u=null,l=_instanceof(e,Uint8Array),A.label=1;case 1:A.trys.push([1,7,,8]),A.label=2;case 2:return l?(c=e,[3,5]):[3,3];case 3:return[4,e.read()];case 4:if(d=A.sent(),f=d.done,p=d.value,f)return[3,6];c=p,A.label=5;case 5:y=!0,_=!1,h=void 0;try{for(v=c[Symbol.iterator]();!(y=(m=v.next()).done);y=!0)g=m.value,S=10===g||13===g,I=10===g&&13===u,w=10===u&&13===g,a.push(g),S||(o+=String.fromCharCode(g)),0===i&&I?"--".concat(r)===o&&(i=1,o="",a=[]):1===i&&w?(s=new Uint8Array(a),i=2,o="",a=[]):2===i&&I?(i=3,o="",a=[]):3===i&&(o.length>r.length+4&&(o=""),"--".concat(r)===o&&(b=a.length-o.length,C=a.slice(0,b-1),i=1,P=n.processHeader(s),E={Headers:P,Body:new Uint8Array(C)},t(E),o="",s=void 0,a=[]),I&&(o="")),u=g}catch(e){_=!0,h=e}finally{try{y||null==v.return||v.return()}finally{if(_)throw h}}return l?[3,6]:[3,2];case 6:return[3,8];case 7:return x=A.sent(),O={Err:new Error(x)},t(O),[3,8];case 8:return[2]}}))}))()}},{key:"parseMultipart",value:function(e,r){var t="--".concat(r);return e.split(t).map((function(e){return e.trim()})).filter((function(e){return""!==e&&"--"!==e}))}},{key:"parseResponsePart",value:function(e){var r=this.parseResponseHeaderFromPart(e).split("\n"),t=new Map;r.forEach((function(e){var r=e.split(": ");2===r.length&&t.set(r[0],r[1])}));var n=this.parseResponseBodyFromPart(e),o=(new TextEncoder).encode(n);return{Headers:t,Body:o}}},{key:"parseResponseBodyFromPart",value:function(e){var r=e.split("\n\r\n");if(2===r.length)return r[1];throw"No response Body"}},{key:"parseResponseHeaderFromPart",value:function(e){var r=e.split("\n\r\n");if(2===r.length)return r[0];throw"No response Headers"}},{key:"processHeader",value:function(e){var r=new Map;if(e){for(var t="",n=0;n<e.byteLength;n+=1)t+=String.fromCharCode(e[n]);t.split("\n").forEach((function(e){var t=e.split(": ");2===t.length&&r.set(t[0],t[1])}))}return r}}]),e}(),h=t(176),v=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"sendTraceTag",value:function(){}},{key:"shipAssertTag",value:function(){}},{key:"debugAssertTag",value:function(){}},{key:"setCorrelationId",value:function(){}}]),e}(),m=new(function(){function e(){_class_call_check(this,e),this.externalLogger=new v}return _create_class(e,[{key:"setCorrelationId",value:function(e){this.externalLogger.setCorrelationId(e)}},{key:"setLogger",value:function(e){this.externalLogger=e}},{key:"sendTraceTag",value:function(e,r,t,n){this.externalLogger.sendTraceTag(e,r,t,n)}},{key:"debugAssertTag",value:function(e,r,t,n){this.externalLogger.debugAssertTag(e,r,t,n)}},{key:"shipAssertTag",value:function(e,r,t,n){this.externalLogger.shipAssertTag(e,r,t,n)}}]),e}());!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry"}(p||(p={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(y||(y={}));var g=t(227),S=function(){function e(r,t,n,o){_class_call_check(this,e),this.parsedResponse={slideOrder:[],slideAllInfo:[]},this.m_settings=r,this.m_responses=t,this.m_perfDictionary=n,this.m_parsedBasedResponse=o}return _create_class(e,[{key:"parsePart",value:function(r){if(r&&r.Headers){this.m_perfDictionary[u.parserCallback]?(this.m_perfDictionary[u.parserCallback].callCounter=this.m_perfDictionary[u.parserCallback].callCounter+1,this.m_perfDictionary[u.parserCallback].lastCallStart=C.performanceNowTrimmed()):this.m_perfDictionary[u.parserCallback]={lastCallStart:C.performanceNowTrimmed(),lastCallEnd:C.performanceNowTrimmed(),callCounter:0,slidesHaveImages:[],slidesHaveImageResources:[]};var t=r.Headers.get(u.ContentDisposition),n=r.Headers.get(u.ContentType);this.m_parsedBasedResponse.usedOutputCache=r.Headers.get(u.XusedOutputCache),this.m_parsedBasedResponse.newSnapUrl=r.Headers.get(u.Xnewsnapurl);var o=r.Headers.get(u.ErrorCode)||c.ErrorRESERVEDSuccess,s=r.Headers.get(u.ErrorCategory)||l.ErrorRESERVEDSuccess,i=r.Headers.get(u.XusedOutputCache);if(t){var a,d=t.indexOf("pres%2fSlideMetadatasldIdx")>0;try{a=decodeURIComponent(t.substring(t.indexOf("name=")+5).trim())}catch(e){m.sendTraceTag(595641600,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::parseMultipartResponse - partResponse Error:".concat(e))}if(a){if(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemUsedOutputCacheMap||(this.m_parsedBasedResponse.itemUsedOutputCacheMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(a,o),this.m_parsedBasedResponse.itemErrorCategoryMap.set(a,s),i&&this.m_parsedBasedResponse.itemUsedOutputCacheMap.set(a,i),o&&o.trim().toLowerCase()===c.ErrorRESERVEDSuccess.toLowerCase())if(t.indexOf("presinfo%2fslimSlideOrder")>0){var f=JSON.parse(new TextDecoder("utf-8").decode(r.Body)),_=!0,v=!1,g=void 0;try{for(var S,I=f[Symbol.iterator]();!(_=(S=I.next()).done);_=!0){var w=S.value;this.parsedResponse.slideOrder.push({sid:w,cid:0})}}catch(e){v=!0,g=e}finally{try{_||null==I.return||I.return()}finally{if(v)throw g}}}else if(t.indexOf("presinfo%2fmetadata")>0){var b=JSON.parse(new TextDecoder("utf-8").decode(r.Body)),P=[],E=!0,x=!1,O=void 0;try{for(var A,T=b.SidSlideOrder[Symbol.iterator]();!(E=(A=T.next()).done);E=!0){var k=A.value;P.push({sid:k,cid:0})}}catch(e){x=!0,O=e}finally{try{E||null==T.return||T.return()}finally{if(x)throw O}}var M=b.SidHiddenSlides?b.SidHiddenSlides.map((function(e){return{sid:e,cid:0}})):h.ChangeGate.isChangeGateEnabled("FixHiddenOrderIfNotPresentInResponse")?void 0:[],R={Item:null};b.SlideShowProperties.Item||(R={Item:null}),b.SlideShowProperties.Item.s?R={Item:{sid:b.SlideShowProperties.Item.s}}:b.SlideShowProperties.Item.st&&(R={Item:{start:b.SlideShowProperties.Item.st,end:b.SlideShowProperties.Item.end}});var j={SlideOrder:P,HiddenSlideOrder:M,SlideEmuWidth:b.SlideEmuWidth,SlideEmuHeight:b.SlideEmuHeight,ViewScalingFactor:b.ViewScalingFactor,SlideShowProperties:R,Sections:b.Sections};this.parsedResponse.slideAllInfo.push(j)}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&n&&e.getSupportedImageType(n)){for(var N=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),W="",F=0;F<r.Body.length;F+=1)W+=String.fromCharCode(r.Body[F]);var D="data:".concat(e.getSupportedImageType(n),";base64, ").concat(btoa(W));this.m_perfDictionary[u.parserCallback].slidesHaveImages.push(N),this.m_responses[N]||(this.m_responses[N]={ID:{sid:N,cid:0}}),this.m_responses[N].SlideImageData=D}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&n&&-1!==n.indexOf("application/json")){var U=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),L=JSON.parse(new TextDecoder("utf-8").decode(r.Body));h.ChangeGate.isChangeGateEnabled("PodsProxy.getItemsMediaResourceMapping")&&L.mediaUrls?(this.m_responses[U]||(this.m_responses[U]={ID:{sid:L.slideShowInfo.sld[0].id,cid:0}}),this.m_responses[U].SlideShowInfo=L.slideShowInfo,this.m_responses[U].MediaUrls=L.mediaUrls):(this.m_responses[U]||(this.m_responses[U]={ID:{sid:L.sld[0].id,cid:0}}),this.m_responses[U].SlideShowInfo=L)}else if(t.indexOf("pres%2fNotesSldSid")>0||t.indexOf("pres%2fNotesSldIdx")>0){var H=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fNotesSldSid")>0?"NotesSldSid":"NotesSldIdx"),J=new TextDecoder("utf-8").decode(r.Body);this.m_responses[H]||(this.m_responses[H]={ID:{sid:H,cid:0}}),this.m_responses[H].NoteHtml=J}else if(t.indexOf("pres%2fCommentsSldSid")>0||t.indexOf("pres%2fCommentsSldIdx")>0){var q=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fCommentsSldSid")>0?"CommentsSldSid":"CommentsSldIdx"),B=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[q]||(this.m_responses[q]={ID:{sid:q,cid:0}}),this.m_responses[q].Comments=B}else if(t.indexOf("pres%2fSlideMetadataSldSid")>0||d){var G=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideMetadataSldSid")>0?"SlideMetadataSldSid":"SlideMetadatasldIdx"),z=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[G]||(this.m_responses[G]={ID:z.ID}),this.m_responses[G].Title=z.Title,this.m_responses[G].HasAnimation=z.HasAnimation,this.m_responses[G].Hidden=z.Hidden,this.m_responses[G].HasTransition=z.HasTransition}else if(t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0||t.indexOf("pres%2fSlideAccessibilityModelSldIdx")>0){var V=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0?"SlideAccessibilityModelSldSid":"SlideAccessibilityModelSldIdx"),K=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[V]||(this.m_responses[V]={ID:K.ID}),this.m_responses[V].AccessibilityModel=K.AccessibilityModel}else if(t.indexOf("Res%2fSldSid")>0&&n&&e.getSupportedImageType(n)){var X=e.extractStringInBetweenStrings(t,"Res%2fSldSid","%2f"),$=e.extractStringInBetweenStrings(t,"filename=","\r");if(X&&$){var Y,Q,Z={sid:+X,cid:0},ee=e.getSupportedImageType(n);if(r.Body)if(this.m_settings.allowImagesAsBinary)Y={Id:$,Base64:"",Binary:r.Body,MimeType:ee,ByteCount:r.Body.length};else{for(var re="",te=0;te<r.Body.length;te+=1)re+=String.fromCharCode(r.Body[te]);var ne="data:".concat(ee,";base64,").concat(btoa(re));Y={Id:$,Base64:ne,MimeType:ee,ByteCount:ne.length}}else m.sendTraceTag(508420494,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::parseMultipartResponse - Body is undefined. slideId:".concat(X,", resourceId:").concat($)),Y={Id:$,Base64:"",MimeType:ee,ByteCount:0};this.m_perfDictionary[u.parserCallback].slidesHaveImageResources.push(Z.sid);var oe=!0,se=!1,ie=void 0;try{for(var ae,ue=Object.entries(this.m_responses)[Symbol.iterator]();!(oe=(ae=ue.next()).done);oe=!0){var ce=_sliced_to_array(ae.value,2)[1];ce.ID&&ce.ID.sid===Z.sid&&(Q=ce)}}catch(e){se=!0,ie=e}finally{try{oe||null==ue.return||ue.return()}finally{if(se)throw ie}}Q?Q.ResourceData?Q.ResourceData.push(Y):Q.ResourceData=[Y]:this.m_responses[Z.sid]={ID:Z,ResourceData:[Y]}}else m.sendTraceTag(595628568,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::parseMultipartResponse - Cannot get slideId or resourceId from header. slideId:".concat(X,", resourceId:").concat($)),this.m_parsedBasedResponse.responseErrorCode=c.ErrorResponseNotValid}}else this.m_parsedBasedResponse.responseErrorCode=c.ErrorItemNameNotValid}else r.Headers.get("x-ms-content-id")&&(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(r.Headers.get("x-ms-content-id"),o),this.m_parsedBasedResponse.itemErrorCategoryMap.set(r.Headers.get("x-ms-content-id"),s)),this.m_parsedBasedResponse.responseErrorCode=c.ErrorContentDispositionHeaderNotValid;this.m_perfDictionary[u.parserCallback].lastCallEnd=C.performanceNowTrimmed()}else this.m_parsedBasedResponse.responseErrorCode=c.ErrorResponseNotValid;r.Err&&(this.m_parsedBasedResponse.responseErrorCode=c.ErrorResponseNotValid,m.sendTraceTag(595687003,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::parseMultipartResponse - partResponse Error:".concat(r.Err)))}}],[{key:"getSupportedImageType",value:function(e){return C.s_supportedImageType.find((function(r){return-1!==e.indexOf(r)}))||""}},{key:"getSlideKeyFromHeader",value:function(e,r){var t=new RegExp(".*".concat(r,"(.*)"));if(!e)return m.sendTraceTag(508420493,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::getSlideLocationFromHeader - header is null."),-1;var n=t.exec(e);return null!=n&&n.length>=2?+n[1]:(m.sendTraceTag(508420492,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::getSlideLocationFromHeader - regex result is null header:".concat(e,", itemId: ").concat(r)),-1)}},{key:"extractStringInBetweenStrings",value:function(e,r,t){var n=e.indexOf(r)+r.length,o=t?e.indexOf(t,n):-1;return-1===o?e.substring(n):e.substring(n,o)}}]),e}(),I=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"load",value:function(r){for(var t in r)e.m_settings[t]=r[t]}},{key:"readBooleanOrDefault",value:function(r,t){var n=void 0===e.m_settings?"":_type_of(e.m_settings[r]);return"string"===n?"true"===e.m_settings[r].toLowerCase():"boolean"===n?e.m_settings[r]:t}},{key:"readNumberOrDefault",value:function(r,t){var n=void 0===e.m_settings?"":_type_of(e.m_settings[r]);return"string"===n||"number"===n?Number(e.m_settings[r]):t}},{key:"readStringOrDefault",value:function(r,t){return void 0===e.m_settings||"string"!=typeof e.m_settings[r]?t:e.m_settings[r]}},{key:"addOrUpdateSettingsFromUrl",value:function(r,t){var n=t.get("wdset");if(!n)return r;var o=!0,s=!1,i=void 0;try{for(var a,u=n.split(",")[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value.split(":"),l=c[0].split("."),d=l[0],f=l[1],p=c[1];f&&p&&e.addOrUpdateSetting(r,d,f,p)}}catch(e){s=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw i}}return r}},{key:"addOrUpdateSetting",value:function(e,r,t,n){"__proto__"!==r&&(e[r]||(e[r]={}),e[r][t]=n)}}]),e}();I.m_settings={};var w={};function b(e){e.logger&&m.setLogger(e.logger),e.settings&&I.load(e.settings?e.settings.podsproxy:{}),e.disabledChangeGates&&h.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=w)}var C=function(){function e(r,t,n,o,s,i,a){var u=this;if(_class_call_check(this,e),this.events=new g.EventEmitter,this.m_requestHeaders=new Headers,this.m_itemsList=new Array,this.m_multipartParser=new _,m.setLogger(o),m.sendTraceTag(508420489,p.msoulscat_Wac_PptSession,r&&t&&t.DownloadUrl&&n&&t.DocID?y.Info:y.Warning,"PodsProxy::constructor - podsUrl:".concat(r,", fileExtension:").concat(n,", docId:").concat(t.DocID,"}")),m.sendTraceTag(508420488,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::constructor - presentUrl:".concat(s,"}")),this.m_podsUrl=r,this.m_presentUrl=s,this.m_downloadUrl=t.DownloadUrl,this.m_settings=a||{timeout:3e4,throwHttpErrors:!0},h.ChangeGate.initSettings({disabledChangeGates:this.m_settings.disabledChangeGates||""}),this.m_wacFallbackDownloadUrl=a?a.wacFallbackDownloadUrl:void 0,i&&i.forEach((function(e,r){u.m_requestHeaders.append(r,e)})),this.m_getPresInfoRequest={Source:t,FileExtension:n||"pptx"},this.m_getItemsRequest={Source:t,FileExtension:n||"pptx",Items:this.m_itemsList},this.m_imageInputProperties={ClientColorSettings:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientWidth:void 0,ClientHeight:void 0,MinClientWidth:void 0,MinClientHeight:void 0,MaxClientWidth:void 0,MaxClientHeight:void 0,TranslateLanguage:void 0},this.m_imageOptions={InputProperties:this.m_imageInputProperties},this.m_slideInfoInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideInfoOptions={InputProperties:this.m_slideInfoInputProperties},this.m_slideResourceInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideResourceOptions={InputProperties:this.m_slideResourceInputProperties,Filters:{EnableClustering:!1}},this.m_slideAccessibilityInputProperties={TranslateLanguage:void 0,LocaleName:void 0},this.m_slideAccessibilityOptions={InputProperties:this.m_slideAccessibilityInputProperties},this.m_presInfoFilters={RenderSlideShowProperties:!0,FilterHiddenSlideInfo:!1,IncludeSections:!1},this.m_presInfoInputProperties={IsHighContrast:!1,ClientColorSettings:""},this.m_presInfoOptions={Filters:this.m_presInfoFilters,InputProperties:this.m_presInfoInputProperties},this.m_errorMap=new Map,this.setErrorMap(),a&&a.perfTimingMonitorEnabled)try{var c=new Set;this.m_presentUrl&&h.ChangeGate.isChangeGateEnabled("PodsProxy.logPFDPerfTiming")&&(c.add("".concat(this.m_presentUrl,"/items")),c.add("".concat(this.m_presentUrl,"/ping"))),c.add("getitems.ashx"),c.add("getmedia.ashx"),c.add("remoteuls.ashx"),c.add("podhandler.ashx"),c.add("remotetelemetry.ashx"),new PerformanceObserver((function(r){return e.logPerformanceEntries(r,c)})).observe({entryTypes:["resource"]})}catch(e){m.sendTraceTag(508420487,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:PerformanceObserver failed with exception ".concat(e))}}return _create_class(e,[{key:"getSlideOrderAsync",value:function(){var e=this;return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return[4,e.getPresInfoAsync("getSlideOrderAsync")];case 1:return[4,t.sent().json()];case 2:return r=t.sent(),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:r.SlideOrder}]}}))}))()}},{key:"getSlideInfosAsync",value:function(e){var r=this;return _async_to_generator((function(){var t;return _ts_generator(this,(function(n){switch(n.label){case 0:return e.RenderOptions&&(r.m_getPresInfoRequest.SlideRanges=[{IDs:e.SlideLocations.map((function(e){return e.slideId})),RenderOptions:e.RenderOptions}]),r.m_getPresInfoRequest.ClientWidth=e.ClientWidth?e.ClientWidth:r.m_getPresInfoRequest.ClientWidth,r.m_getPresInfoRequest.ClientHeight=e.ClientHeight?e.ClientHeight:r.m_getPresInfoRequest.ClientHeight,r.m_getPresInfoRequest.DevicePixelRatio=e.DevicePixelRatio?e.DevicePixelRatio:r.m_getPresInfoRequest.DevicePixelRatio,r.m_getPresInfoRequest.IsHighContrast=e.IsHighContrast?e.IsHighContrast:r.m_getPresInfoRequest.IsHighContrast,r.m_getPresInfoRequest.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:r.m_getPresInfoRequest.ClientColorSettings,r.m_getPresInfoRequest.MinClientWidth=e.MinClientWidth?e.MinClientWidth:r.m_getPresInfoRequest.MinClientWidth,r.m_getPresInfoRequest.MinClientHeight=e.MinClientHeight?e.MinClientHeight:r.m_getPresInfoRequest.MinClientHeight,r.m_getPresInfoRequest.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:r.m_getPresInfoRequest.MaxClientWidth,r.m_getPresInfoRequest.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:r.m_getPresInfoRequest.MaxClientHeight,[4,r.getPresInfoAsync("getSlideInfosAsync")];case 1:return[4,n.sent().json()];case 2:return t=n.sent(),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:t.Slides}]}}))}))()}},{key:"getItemsSlideOrderAsync",value:function(){var e=this;return _async_to_generator((function(){var r,t;return _ts_generator(this,(function(n){switch(n.label){case 0:return e.m_itemsList=new Array,e.m_itemsList.push({Id:d.PresinfoslimSlideOrder,AcceptTypes:[f.JsonType]}),e.m_getItemsRequest.Items=e.m_itemsList,[4,e.getItemsAsync("getItemsSlideOrderAsync")];case 1:return r=n.sent(),t={},[4,e.createSlideIdResponse(e.parseMultipartResponseAsync(r,t))];case 2:return[2,n.sent()]}}))}))()}},{key:"getItemsPresInfoAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,s,i,a,c;return _ts_generator(this,(function(l){switch(l.label){case 0:return t.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:t.m_presInfoInputProperties.ClientHeight,t.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:t.m_presInfoInputProperties.ClientWidth,t.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:t.m_presInfoInputProperties.IsHighContrast,t.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:t.m_presInfoInputProperties.ClientColorSettings,t.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:t.m_presInfoFilters.FilterHiddenSlideInfo,t.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:t.m_presInfoFilters.IncludeSections,t.m_itemsList=new Array,t.m_itemsList.push({Id:d.PresInfoMetaData,AcceptTypes:[f.JsonType],Options:JSON.stringify(t.m_presInfoOptions)}),t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(u.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(u.XCorrelationId,r.CorrelationId||""),n=_object_spread_props(_object_spread({},r.RequestInfo,t.m_settings.sessionInfo),{CorrelationId:r.CorrelationId}),t.m_requestHeaders.set(u.RequestInfo,JSON.stringify(n)),o=t.objectDictionaryToRequestIdString(n),t.m_requestHeaders.set(u.clientRequestIdHeader,o),t.m_requestHeaders.set(u.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),t.m_requestHeaders.set(u.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),s={action:"getItemsPresInfoAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(s),[4,t.getItemsAsync("getItemsPresInfoAsync")];case 1:return i=l.sent(),s[u.server].end=e.performanceNowTrimmed(),i&&i.response&&i.response.headers&&(s[u.contentLength]=i.response.headers.get(u.ContentLength)),e.logPerf(s),s[u.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},a=t.setTimeoutForParsingResponse(s),[4,t.createPresInfoResponse(t.parseMultipartResponseAsync(i,s))];case 2:return c=l.sent(),clearTimeout(a),s[u.parser].end=e.performanceNowTrimmed(),s[u.usedOutputCache]=!!c.usedOutputCache&&"true"===c.usedOutputCache.trim().toLowerCase(),s[u.itemUsedOutputCacheMap]=!!c.itemUsedOutputCacheMap&&Array.from(c.itemUsedOutputCacheMap.entries()),e.logPerf(s),c.metadata=t.generateReportPerfDictionary(s),[2,c]}}))}))()}},{key:"getItemsPresInfoAndSlideInfosAsync",value:function(r,t,s){var i=this;return _async_to_generator((function(){var a,_,h,v,g,S,I,w,b,C,P,E,x,O,A,T,k;return _ts_generator(this,(function(M){switch(M.label){case 0:a={action:"getItemsPresInfoAndSlideInfoAsync"},_=null,M.label=1;case 1:for(M.trys.push([1,4,,5]),i.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:i.m_presInfoInputProperties.ClientHeight,i.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:i.m_presInfoInputProperties.ClientWidth,i.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:i.m_presInfoInputProperties.IsHighContrast,i.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:i.m_presInfoInputProperties.ClientColorSettings,i.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:i.m_presInfoFilters.FilterHiddenSlideInfo,i.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:i.m_presInfoFilters.IncludeSections,i.m_itemsList=new Array,i.m_itemsList.push({Id:d.PresInfoMetaData,AcceptTypes:[f.JsonType],Options:JSON.stringify(i.m_presInfoOptions)}),i.m_imageOptions.InputProperties.ClientWidth=t.ClientWidth?t.ClientWidth:i.m_imageInputProperties.ClientWidth,i.m_imageOptions.InputProperties.ClientHeight=t.ClientHeight?t.ClientHeight:i.m_imageInputProperties.ClientHeight,i.m_imageOptions.InputProperties.IsHighContrast=t.IsHighContrast?t.IsHighContrast:i.m_imageInputProperties.IsHighContrast,i.m_imageOptions.InputProperties.ClientColorSettings=t.ClientColorSettings?t.ClientColorSettings:i.m_imageInputProperties.ClientColorSettings,i.m_imageOptions.InputProperties.MinClientWidth=t.MinClientWidth?t.MinClientWidth:i.m_imageInputProperties.MinClientWidth,i.m_imageOptions.InputProperties.MinClientHeight=t.MinClientHeight?t.MinClientHeight:i.m_imageInputProperties.MinClientHeight,i.m_imageOptions.InputProperties.MaxClientWidth=t.MaxClientWidth?t.MaxClientWidth:i.m_imageInputProperties.MaxClientWidth,i.m_imageOptions.InputProperties.MaxClientHeight=t.MaxClientHeight?t.MaxClientHeight:i.m_imageInputProperties.MaxClientHeight,i.m_imageOptions.InputProperties.TranslateLanguage=null!=t.TranslateLanguage?t.TranslateLanguage:i.m_imageInputProperties.TranslateLanguage,h=0;h<t.SlideLocations.length;h+=1)t.GetSlideImage?i.m_itemsList.push({Id:t.SlideLocations[h].slideId?d.slideInfoSid+t.SlideLocations[h].slideId.sid.toString():d.slideInfoIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:e.s_supportedImageType,Options:JSON.stringify(i.m_imageOptions)}):t.Filters&&(i.m_slideInfoOptions.InputProperties={ClientWidth:t.ClientWidth?t.ClientWidth:i.m_slideInfoInputProperties.ClientWidth,ClientHeight:t.ClientHeight?t.ClientHeight:i.m_slideInfoInputProperties.ClientHeight,IsHighContrast:t.IsHighContrast?t.IsHighContrast:i.m_slideInfoInputProperties.IsHighContrast,ColorMode:t.ColorMode?t.ColorMode:i.m_slideInfoInputProperties.ColorMode,ClientColorSettings:t.ClientColorSettings?t.ClientColorSettings:i.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:i.m_slideInfoInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:i.m_slideInfoInputProperties.LocaleName},i.m_slideInfoOptions.Filters=e.ensureISlideInfoFilters(t.Filters),i.m_itemsList.push({Id:t.SlideLocations[h].slideId?d.slideInfoSid+t.SlideLocations[h].slideId.sid.toString():d.slideInfoIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:JSON.stringify(i.m_slideInfoOptions)})),i.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:i.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:i.m_slideInfoInputProperties.LocaleName},void 0!==t.GetSlideAccessibilityModelData&&t.GetSlideAccessibilityModelData&&i.m_itemsList.push({Id:t.SlideLocations[h].slideId?d.slideAccessibilityModelSid+t.SlideLocations[h].slideId.sid.toString():d.slideAccessibilityModelIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:JSON.stringify(i.m_slideAccessibilityOptions)}),t.GetSlideNotes&&i.m_itemsList.push({Id:t.SlideLocations[h].slideId?d.slideNotesSid+t.SlideLocations[h].slideId.sid.toString():d.slideCommentsIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:[f.PlainTextType],Options:JSON.stringify(i.m_slideInfoOptions)}),t.GetSlideComments&&i.m_itemsList.push({Id:t.SlideLocations[h].slideId?d.slideCommentsSid+t.SlideLocations[h].slideId.sid.toString():d.slideCommentsIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:t.CommentOptions});return i.m_getItemsRequest.Items=i.m_itemsList,i.m_requestHeaders.set(u.CallerCorrelationId,r.CorrelationId||""),i.m_requestHeaders.set(u.XCorrelationId,r.CorrelationId||""),v=_object_spread_props(_object_spread({},r.RequestInfo,i.m_settings.sessionInfo),{CorrelationId:r.CorrelationId}),i.m_requestHeaders.set(u.RequestInfo,JSON.stringify(v)),g=i.objectDictionaryToRequestIdString(v),i.m_requestHeaders.set(u.clientRequestIdHeader,g),i.m_requestHeaders.set(u.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),i.m_requestHeaders.set(u.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),a.correlationId=r.CorrelationId,a[u.server]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(a),i.events.emit("requestStageChanged",{requestType:n.getItemsPresInfoAndSlideInfoAsync,stageInfo:o.GetItemsCall}),[4,i.getItemsAsync("getItemsPresInfoAndSlideInfoAsync",{overrideGetItemsTimeoutMs:s&&s.overrideGetItemsTimeoutMs})];case 2:if(S=M.sent(),i.m_settings.shouldUpdateNewFileUrlFromSnap&&S.errorCode===c.ServerErrorFileDownloadResourceInconsistent)return[2,{presInfo:void 0,slideInfo:[],responseErrorCode:c.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:S.errorCategory,responseIsIntentional:S.isIntentional,itemErrorCodeMap:void 0}];if(a[u.server].end=e.performanceNowTrimmed(),S&&S.response&&S.response.headers&&(a[u.contentLength]=S.response.headers.get(u.ContentLength),a[u.ContenEncoding]=S.response.headers.get(u.ContenEncoding),a[u.TransferEncoding]=S.response.headers.get(u.TransferEncoding),I=S.response.headers.keys())){w=[],b=!0,C=!1,P=void 0;try{for(E=I[Symbol.iterator]();!(b=(x=E.next()).done);b=!0)O=x.value,w.push(O)}catch(e){C=!0,P=e}finally{try{b||null==E.return||E.return()}finally{if(C)throw P}}a[u.ResponseHeaders]=w}return e.logPerf(a),a[u.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},_=i.setTimeoutForParsingResponse(a),[4,i.parseMultipartResponseAsync(S,a,{shouldTimeoutResponseStreamDownload:s&&s.shouldTimeoutResponseStreamDownload,overrideDownloadTimeoutMs:s&&s.overrideDownloadTimeoutMs,requestType:n.getItemsPresInfoAndSlideInfoAsync})];case 3:return(A=M.sent())&&A.responseErrorCode===c.ErrorDownloadResponseStreamTimeout?[2,{presInfo:void 0,slideInfo:[],responseErrorCode:c.ErrorDownloadResponseStreamTimeout,responseErrorCategory:l.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0}]:(T=i.createPresInfoAndSlideInfoResponse(A,a),null!==_&&(clearTimeout(_),_=null),a[u.parser].end=e.performanceNowTrimmed(),a[u.usedOutputCache]=!!T.usedOutputCache&&"true"===T.usedOutputCache.trim().toLowerCase(),a[u.itemUsedOutputCacheMap]=!!T.itemUsedOutputCacheMap&&Array.from(T.itemUsedOutputCacheMap.entries()),a[u.podsProxyCallSuceeded]=!0,e.logPerf(a),T.metadata=i.generateReportPerfDictionary(a),[2,T]);case 4:return k=M.sent(),m.sendTraceTag(508420486,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getItemsPresInfoAndSlideInfosAsync - exception happened: ".concat(k)),a[u.podsProxyCallSuceeded]=!1,e.logPerf(a),null!==_&&(clearTimeout(_),_=null),[2,{presInfo:void 0,slideInfo:[],responseErrorCode:c.ErrorRESERVEDItemFailed,responseErrorCategory:l.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0}];case 5:return[2]}}))}))()}},{key:"getItemsSlideInfosAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,s,i,a,_,h,v,g,S;return _ts_generator(this,(function(I){switch(I.label){case 0:n={action:"getItemsSlideInfosAsync"},I.label=1;case 1:for(I.trys.push([1,7,,8]),t.m_imageOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:t.m_imageInputProperties.ClientWidth,t.m_imageOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:t.m_imageInputProperties.ClientHeight,t.m_imageOptions.InputProperties.IsHighContrast=null!=r.IsHighContrast?r.IsHighContrast:t.m_imageInputProperties.IsHighContrast,t.m_imageOptions.InputProperties.ColorMode=null!=r.ColorMode?r.ColorMode:t.m_imageInputProperties.ColorMode,t.m_imageOptions.InputProperties.ClientColorSettings=null!=r.ClientColorSettings?r.ClientColorSettings:t.m_imageInputProperties.ClientColorSettings,t.m_imageOptions.InputProperties.MinClientWidth=r.MinClientWidth?r.MinClientWidth:t.m_imageInputProperties.MinClientWidth,t.m_imageOptions.InputProperties.MinClientHeight=r.MinClientHeight?r.MinClientHeight:t.m_imageInputProperties.MinClientHeight,t.m_imageOptions.InputProperties.MaxClientWidth=r.MaxClientWidth?r.MaxClientWidth:t.m_imageInputProperties.MaxClientWidth,t.m_imageOptions.InputProperties.MaxClientHeight=r.MaxClientHeight?r.MaxClientHeight:t.m_imageInputProperties.MaxClientHeight,t.m_imageOptions.InputProperties.TranslateLanguage=null!=r.TranslateLanguage?r.TranslateLanguage:t.m_imageInputProperties.TranslateLanguage,t.m_itemsList=new Array,o=0;o<r.SlideLocations.length;o+=1)r.GetSlideImage?t.m_itemsList.push({Id:r.SlideLocations[o].slideId?d.slideInfoSid+r.SlideLocations[o].slideId.sid.toString():d.slideInfoIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:e.s_supportedImageType,Options:JSON.stringify(t.m_imageOptions)}):r.Filters&&(t.m_slideInfoOptions.InputProperties={ClientWidth:r.ClientWidth?r.ClientWidth:t.m_slideInfoInputProperties.ClientWidth,ClientHeight:r.ClientHeight?r.ClientHeight:t.m_slideInfoInputProperties.ClientHeight,IsHighContrast:r.IsHighContrast?r.IsHighContrast:t.m_slideInfoInputProperties.IsHighContrast,ColorMode:r.ColorMode?r.ColorMode:t.m_slideInfoInputProperties.ColorMode,ClientColorSettings:r.ClientColorSettings?r.ClientColorSettings:t.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideInfoInputProperties.TranslateLanguage,LocaleName:null!=r.LocaleName?r.LocaleName:t.m_slideInfoInputProperties.LocaleName},t.m_slideInfoOptions.Filters=e.ensureISlideInfoFilters(r.Filters),r.SkipGetSlideInfo||t.m_itemsList.push({Id:r.SlideLocations[o].slideId?d.slideInfoSid+r.SlideLocations[o].slideId.sid.toString():d.slideInfoIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:JSON.stringify(t.m_slideInfoOptions)})),t.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:r.LocaleName?r.LocaleName:t.m_slideInfoInputProperties.LocaleName},void 0!==r.GetSlideAccessibilityModelData&&r.GetSlideAccessibilityModelData&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?d.slideAccessibilityModelSid+r.SlideLocations[o].slideId.sid.toString():d.slideAccessibilityModelIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:JSON.stringify(t.m_slideAccessibilityOptions)}),r.GetSlideNotes&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?d.slideNotesSid+r.SlideLocations[o].slideId.sid.toString():d.slideCommentsIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[f.PlainTextType],Options:JSON.stringify(t.m_slideInfoOptions)}),r.GetSlideComments&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?d.slideCommentsSid+r.SlideLocations[o].slideId.sid.toString():d.slideCommentsIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:r.CommentOptions});return 0===t.m_itemsList.length?(m.sendTraceTag(508420485,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getItemsSlideInfosAsync - invalid request item list"),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRequestFailed,responseErrorCategory:l.BadRequest,responseIsIntentional:!1,slideInfo:[]}]):(t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(u.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(u.XCorrelationId,r.CorrelationId||""),s=_object_spread_props(_object_spread({},r.RequestInfo,t.m_settings.sessionInfo),{CorrelationId:r.CorrelationId}),t.m_requestHeaders.set(u.RequestInfo,JSON.stringify(s)),i=t.objectDictionaryToRequestIdString(s),t.m_requestHeaders.set(u.clientRequestIdHeader,i),t.m_requestHeaders.set(u.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),t.m_requestHeaders.set(u.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),(a={action:"getItemsSlideInfosAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}}).correlationId=r.CorrelationId,a[u.server]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(a),t.m_settings.shouldFixSlideDataOrder?(r.GetSlideComments&&(h={isGetSlideCommentsRequest:!0}),[4,t.getItemsAsync("getItemsSlideInfosAsync",h)]):[3,3]);case 2:return _=I.sent(),[3,5];case 3:return[4,t.getItemsAsync("getItemsSlideInfosAsync")];case 4:_=I.sent(),I.label=5;case 5:return t.m_settings.shouldUpdateNewFileUrlFromSnap&&_.errorCode===c.ServerErrorFileDownloadResourceInconsistent?[2,{slideInfo:[],responseErrorCode:c.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:_.errorCategory,responseIsIntentional:!!_.headers.get(u.IsIntentional)&&_.headers.get(u.IsIntentional),itemErrorCodeMap:void 0}]:(a[u.server].end=e.performanceNowTrimmed(),_&&_.response&&_.response.headers&&(a[u.contentLength]=_.response.headers.get(u.ContentLength)),a[u.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(a),v=t.setTimeoutForParsingResponse(a),[4,t.createSlideInfoResponse(t.parseMultipartResponseAsync(_,a),a)]);case 6:return g=I.sent(),clearTimeout(v),a[u.parser].end=e.performanceNowTrimmed(),a[u.usedOutputCache]=!!g.usedOutputCache&&"true"===g.usedOutputCache.trim().toLowerCase(),a[u.itemUsedOutputCacheMap]=!!g.itemUsedOutputCacheMap&&Array.from(g.itemUsedOutputCacheMap.entries()),a[u.podsProxyCallSuceeded]=!0,e.logPerf(a),g.metadata=t.generateReportPerfDictionary(a),[2,g];case 7:return S=I.sent(),m.sendTraceTag(508420484,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getItemsSlideInfosAsync - exception happened: ".concat(S)),n[u.podsProxyCallSuceeded]=!1,e.logPerf(n),[2,{slideInfo:[],responseErrorCode:c.ErrorRESERVEDItemFailed,responseErrorCategory:l.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0}];case 8:return[2]}}))}))()}},{key:"getItemsResourceAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,s,i,a,c,l,d,p,y,_,h;return _ts_generator(this,(function(v){switch(v.label){case 0:t.m_slideResourceOptions.InputProperties={ClientWidth:r.ClientWidth?r.ClientWidth:t.m_slideResourceInputProperties.ClientWidth,ClientHeight:r.ClientHeight?r.ClientHeight:t.m_slideResourceInputProperties.ClientHeight,IsHighContrast:r.IsHighContrast?r.IsHighContrast:t.m_slideResourceInputProperties.IsHighContrast,ColorMode:r.ColorMode?r.ColorMode:t.m_slideResourceInputProperties.ColorMode,ClientColorSettings:r.ClientColorSettings?r.ClientColorSettings:t.m_slideResourceInputProperties.ClientColorSettings,TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideResourceInputProperties.TranslateLanguage,LocaleName:null!=r.LocaleName?r.LocaleName:t.m_slideResourceInputProperties.LocaleName},t.m_slideResourceOptions.Filters.EnableClustering=void 0!==r.EnableClustering&&r.EnableClustering,t.m_itemsList=new Array,n=!0,o=!1,s=void 0;try{for(i=r.ResourceParams[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){switch(c=a.value,t.m_slideResourceOptions.InputProperties.ResourceId=c.Id,l=String(c.Name.match("[^.]+$")),d="",l){case"jpg":d=f.ImageJpg;break;case"png":d=f.ImagePng}t.m_itemsList.push({Id:c.Name,AcceptTypes:d?[d]:e.s_supportedImageType,Options:JSON.stringify(t.m_slideResourceOptions)})}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}return t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(u.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(u.XCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(u.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),p={action:"getItemsResourceAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(p),[4,t.getItemsAsync("getItemsResourceAsync")];case 1:return y=v.sent(),p[u.server].end=e.performanceNowTrimmed(),y&&y.response&&y.response.headers&&(p[u.contentLength]=y.response.headers.get(u.ContentLength)),p[u.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(p),_=t.setTimeoutForParsingResponse(p),[4,t.createSlideInfoResponse(t.parseMultipartResponseAsync(y,p),p)];case 2:return h=v.sent(),clearTimeout(_),p[u.parser].end=e.performanceNowTrimmed(),p[u.usedOutputCache]=!!h.usedOutputCache&&"true"===h.usedOutputCache.trim().toLowerCase(),p[u.itemUsedOutputCacheMap]=!!h.itemUsedOutputCacheMap&&Array.from(h.itemUsedOutputCacheMap.entries()),e.logPerf(p),h.metadata=t.generateReportPerfDictionary(p),[2,h]}}))}))()}},{key:"getItemsSlideOrderAndSlidesInfoIndexAsync",value:function(r,t,n){var o=this;return _async_to_generator((function(){var s,i,a,c,l;return _ts_generator(this,(function(p){switch(p.label){case 0:return o.m_getItemsRequest.Items.push({Id:d.PresinfoslimSlideOrder,AcceptTypes:[f.JsonType],Options:JSON.stringify(n)}),s=JSON.stringify(t),r&&r.forEach((function(e){o.m_getItemsRequest.Items.push({Id:"".concat(d.slideInfoIndex).concat(e),AcceptTypes:[f.ImagePng,f.ImageJpg],Options:s})})),i={action:"getItemsSlideOrderAndSlidesInfoIndexAsync",server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(i),[4,o.getItemsAsync("getItemsSlideOrderAndSlidesInfoIndexAsync")];case 1:return a=p.sent(),i[u.server].end=e.performanceNowTrimmed(),i[u.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},a&&a.response&&a.response.headers&&(i[u.contentLength]=a.response.headers.get(u.ContentLength)),e.logPerf(i),c=o.setTimeoutForParsingResponse(i),[4,o.createSlideOrderAndSlidesInfoIndexResponse(o.parseMultipartResponseAsync(a,i))];case 2:return l=p.sent(),clearTimeout(c),i[u.parser].end=e.performanceNowTrimmed(),i[u.usedOutputCache]=!!l.usedOutputCache&&"true"===l.usedOutputCache.trim().toLowerCase(),i[u.itemUsedOutputCacheMap]=!!l.itemUsedOutputCacheMap&&Array.from(l.itemUsedOutputCacheMap.entries()),e.logPerf(i),l.metadata=o.generateReportPerfDictionary(i),[2,l]}}))}))()}},{key:"getItemsPresInfoAndSlideInfoIndexAsync",value:function(r,t,n){var o=this;return _async_to_generator((function(){var s,i,a,c,l;return _ts_generator(this,(function(p){switch(p.label){case 0:return o.m_presInfoOptions.InputProperties.ClientHeight=n.ClientHeight?n.ClientHeight:o.m_presInfoInputProperties.ClientHeight,o.m_presInfoOptions.InputProperties.ClientWidth=n.ClientWidth?n.ClientWidth:o.m_presInfoInputProperties.ClientWidth,o.m_presInfoOptions.InputProperties.IsHighContrast=n.IsHighContrast?n.IsHighContrast:o.m_presInfoInputProperties.IsHighContrast,o.m_presInfoOptions.InputProperties.ClientColorSettings=n.ClientColorSettings?n.ClientColorSettings:o.m_presInfoInputProperties.ClientColorSettings,o.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==n.FilterHiddenSlideInfo?n.FilterHiddenSlideInfo:o.m_presInfoFilters.FilterHiddenSlideInfo,o.m_presInfoOptions.Filters.IncludeSections=void 0!==n.IncludeSections?n.IncludeSections:o.m_presInfoFilters.IncludeSections,o.m_getItemsRequest.Items.push({Id:d.PresInfoMetaData,AcceptTypes:[f.JsonType],Options:JSON.stringify(o.m_presInfoOptions)}),s=JSON.stringify(t),r&&r.forEach((function(e){o.m_getItemsRequest.Items.push({Id:"".concat(d.slideInfoIndex).concat(e),AcceptTypes:[f.ImagePng,f.ImageJpg],Options:s})})),i={action:"getItemsPresInfoAndSlideInfoIndexAsync",server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},[4,o.getItemsAsync("getItemsPresInfoAndSlideInfoIndexAsync")];case 1:return a=p.sent(),i[u.server].end=e.performanceNowTrimmed(),i[u.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},a&&a.response&&a.response.headers&&(i[u.contentLength]=a.response.headers.get(u.ContentLength)),c=o.setTimeoutForParsingResponse(i),[4,o.createPresInfoAndSlideInfoIndexResponse(o.parseMultipartResponseAsync(a,i))];case 2:return l=p.sent(),clearTimeout(c),i[u.parser].end=e.performanceNowTrimmed(),i[u.usedOutputCache]=!!l.usedOutputCache&&"true"===l.usedOutputCache.trim().toLowerCase(),i[u.itemUsedOutputCacheMap]=!!l.itemUsedOutputCacheMap&&Array.from(l.itemUsedOutputCacheMap.entries()),e.logPerf(i),l.metadata=o.generateReportPerfDictionary(i),[2,l]}}))}))()}},{key:"getPresInfoAsync",value:function(e){var r=this;return _async_to_generator((function(){var t,n,o;return _ts_generator(this,(function(s){switch(s.label){case 0:return m.sendTraceTag(508420483,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::getPresInfoAsync - Function:".concat(e,", requestCorrelation:").concat(r.m_requestHeaders.get(u.CallerCorrelationId))),t=new AbortController,n=setTimeout((function(){return t.abort()}),3e4),[4,fetch("".concat(r.m_podsUrl,"/presinfo.ashx"),{headers:r.m_requestHeaders,method:"POST",body:JSON.stringify(r.m_getPresInfoRequest),signal:t.signal}).catch(function(){var r=_async_to_generator((function(r){return _ts_generator(this,(function(t){throw m.sendTraceTag(508420482,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getPresInfo - Function: ".concat(e,", Error: ").concat(r)),r}))}));return function(e){return r.apply(this,arguments)}}())];case 1:return o=s.sent(),clearTimeout(n),m.sendTraceTag(508420481,p.msoulscat_Wac_PptSession,o.ok?y.Info:y.Error,"PodsProxy::getPresInfo - Function: ".concat(e,", Status:").concat(o.status,", StatusText: ").concat(o.statusText,", CorrelationId: ").concat(o.headers.get(u.XCorrelationId))),[2,o]}}))}))()}},{key:"logGetItemFailureServerHeaders",value:function(e,r,t,n){return _async_to_generator((function(){var o;return _ts_generator(this,(function(s){return(o={functionName:e,requestCorrelation:r,usePresentFrontDoor:t}).headerCorrelationId=n&&n.headers?n.headers.get(u.XCorrelationId):u.unknown,o.headerErrorCode=n&&n.headers?n.headers.get(u.ErrorCode):u.unknown,o.xHeaderErrorCode=n&&n.headers?n.headers.get(u.XErrorCode):u.unknown,o.headerErrorCategory=n&&n.headers?n.headers.get(u.ErrorCategory):u.unknown,o.headerErrorIntentional=!(!n||!n.headers)&&n.headers.get(u.IsIntentional),o.status=n&&n.status?n.status:u.unknown,m.sendTraceTag(506852878,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:logGetItemFailureServerHeaders - ".concat(JSON.stringify(o))),[2]}))}))()}},{key:"getItemsAsync",value:function(r,t){var n=this;return _async_to_generator((function(){var o,s,i,a,d,f,_,h,v,g,S;return _ts_generator(this,(function(w){switch(w.label){case 0:return o=n.m_requestHeaders.get(u.CallerCorrelationId),m.sendTraceTag(508420480,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::getItemsAsync - Function:".concat(r,", requestCorrelation:").concat(o)),s={errorCode:c.ErrorRESERVEDSuccess},i=s,a="getItemsPresInfoAndSlideInfoAsync"===r&&n.m_settings.shouldUseBootRequestTimeout&&n.m_settings.bootRequestTimeout?n.m_settings.bootRequestTimeout:n.m_settings.timeout,t&&t.overrideGetItemsTimeoutMs&&(a=t.overrideGetItemsTimeoutMs),n.m_requestHeaders.set(u.dateHeader,(new Date).toISOString()),n.m_requestHeaders.set(u.clientTimeoutHeader,a.toString()),n.m_requestHeaders.set(u.callId,n.m_settings.callId||"empty"),d=!1,f="".concat(n.m_podsUrl,"/getitems.ashx"),_=t&&t.isGetSlideCommentsRequest,n.m_settings.shouldFixSlideDataOrder&&(_&&n.m_wacFallbackDownloadUrl?n.m_getItemsRequest.Source.DownloadUrl=n.m_wacFallbackDownloadUrl:n.m_getItemsRequest.Source.DownloadUrl=n.m_downloadUrl),_||!n.m_settings.pptoPresentFrontDoorEnabled&&!I.readBooleanOrDefault("enableUsePresentFrontdoor",!1)||(n.m_presentUrl?(f="".concat(n.m_presentUrl,"/items"),d=!0):m.sendTraceTag(508420451,p.msoulscat_Wac_PptSession,y.Warning,"PodsProxy::getItemsAsync enableUsePresentFrontdoor is true but presentUrl is null. Using podsUrl. }")),h=n.m_getItemsRequest.Items.map((function(e){return e.Id})),e.s_events.emit("networkCall",{url:f,itemIds:h}),v=new AbortController,g=setTimeout((function(){return v.abort()}),a),[4,fetch(f,{headers:n.m_requestHeaders,method:"POST",body:JSON.stringify(n.m_getItemsRequest),signal:v.signal}).catch(function(){var t=_async_to_generator((function(t){var i,a,f,_,h,v,g,S;return _ts_generator(this,(function(I){return i=t.response&&t.response.headers?t.response.headers.get(u.XCorrelationId):u.unknown,a=t.response&&t.response.headers?t.response.headers.get(u.ErrorCode):u.unknown,f=t.response&&t.response.headers?t.response.headers.get(u.XErrorCode):u.unknown,_=t.response&&t.response.headers?t.response.headers.get(u.ErrorCategory):u.unknown,h=!(!t.response||!t.response.headers)&&t.response.headers.get(u.IsIntentional),v=t.response&&t.response.status?t.response.status:u.unknown,(g=t.toString()).length>0&&("."===g.slice(-1)||"。"===g.slice(-1))&&(g=g.slice(0,-1)),(S=n.getMappedError(g))?s.errorCode=S:"HTTPError"===t.name&&v!==u.unknown&&500!==v&&n.m_errorMap.has(v)?s.errorCode=n.m_errorMap.get(v):"TimeoutError"===t.name?s.errorCode=c.ErrorRequestTimeout:s.errorCode=e.convertServerError(a,n.m_settings.enableServerSpecificErrorCode),n.m_settings.shouldUpdateNewFileUrlFromSnap&&s.errorCode===c.ServerErrorFileDownloadResourceInconsistent&&(s.newSnapUrl=e.getFieldFromReponseHeader(t.response,u.newSnapUrlHeader)),s.errorCategory=_&&""!==_.trim()&&_!==u.unknown?_:l.Transient,s.isIntentional=h!==u.unknown&&h,m.sendTraceTag(595687001,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getItems - Function:".concat(r,", Error:").concat(t,", ErrorName:").concat(t.name,", Status:").concat(t.status,", HeaderCorrelationId:").concat(i,", HeaderErrorCode:").concat(a,", HeaderErrorCategory:").concat(_,", result.isIntentional:").concat(s.isIntentional,", result.errorCode:").concat(s.errorCode,", requestCorrelation:").concat(o,", status:").concat(v,", xErrorCode:").concat(f,", usePresentFrontDoor:").concat(d)),[2,s]}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return i=w.sent(),m.sendTraceTag(506852877,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy:getItemsAsync - fixErrorLoggingGetItemsPodsProxy: ".concat(I.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1))),I.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1)&&i&&!1===i.ok?[4,n.logGetItemFailureServerHeaders(r,o,d,i)]:[3,3];case 2:w.sent(),w.label=3;case 3:clearTimeout(g),s.response=i;try{if(n.m_settings.shouldUpdateNewFileUrlFromSnap&&(s.errorCode===c.ServerErrorFileDownloadResourceInconsistent||s.newSnapUrl)){if(m.sendTraceTag(508420449,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy:getItems trigger shouldUpdateNewFileUrlFromSnap flow"),s.newSnapUrl)return s.errorCode===c.ErrorRESERVEDSuccess&&m.sendTraceTag(508420448,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:got new snap url without errorcode"),m.sendTraceTag(508420447,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy:getItems get valid new file url"),n.events.emit("downloadUrlChanged",s.newSnapUrl),[2,s];m.sendTraceTag(508420446,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){m.sendTraceTag(508420445,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return 200!==i.status&&s.errorCode===c.ErrorRESERVEDSuccess&&(i.headers&&i.headers.get(u.ErrorCode)?(s[u.errorCode]=e.convertServerError(i.headers.get(u.ErrorCode),n.m_settings.enableServerSpecificErrorCode),s[u.errorCategory]=i.headers.get(u.ErrorCategory)?i.headers.get(u.ErrorCategory):l.BadRequest,s[u.IsIntentional]=!!i.headers.get(u.IsIntentional)&&i.headers.get(u.IsIntentional)):(i.status!==u.unknown&&n.m_errorMap.has(i.status)?s[u.errorCode]=n.m_errorMap.get(i.status):s[u.errorCode]=c.ErrorRequestFailed,s[u.errorCategory]=l.Transient,s[u.IsIntentional]=!1)),S={functionName:r,status:i.status,statusText:i.statusText,headerCorrelation:i.headers?i.headers.get(u.XCorrelationId):"",headerErrorCode:i.headers?i.headers.get(u.ErrorCode):"",headerErrorCategory:i.headers?i.headers.get(u.ErrorCategory):"",headerErrorIntentional:!!i.headers&&i.headers.get(u.IsIntentional),requestCorrelation:o,resultErrorCode:s.errorCode,resultErrorCategory:s.errorCategory,resultIsIntentional:s.IsIntentional},m.sendTraceTag(595687002,p.msoulscat_Wac_PptSession,i.ok?y.Info:y.Error,JSON.stringify(S)),[2,s]}}))}))()}},{key:"getSessionUtcAsync",value:function(){var e=this;return _async_to_generator((function(){var r,t,n,o,s;return _ts_generator(this,(function(i){switch(i.label){case 0:return r=-1,t=new AbortController,n=setTimeout((function(){return t.abort()}),2500),[4,fetch("".concat(e.m_podsUrl,"/podhandler.ashx?action=GetSessionUTC&format=jsms"),{headers:new Headers,method:"GET",signal:t.signal}).catch(function(){var e=_async_to_generator((function(e){return _ts_generator(this,(function(r){return m.sendTraceTag(508420444,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getSessionUtcAsync - Error: ".concat(e)),[2]}))}));return function(r){return e.apply(this,arguments)}}())];case 1:o=i.sent(),clearTimeout(n),i.label=2;case 2:return i.trys.push([2,6,,7]),o?[4,o.text()]:[3,4];case 3:return r=parseInt.apply(void 0,[i.sent(),10]),m.sendTraceTag(508420443,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::getSessionUtcAsync: ".concat(r)),[3,5];case 4:m.sendTraceTag(508420442,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getSessionUtcAsync - Null response."),i.label=5;case 5:return[3,7];case 6:return s=i.sent(),m.sendTraceTag(508420441,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::getSessionUtcAsync - error parsing response. ".concat(s)),[3,7];case 7:return[2,r]}}))}))()}},{key:"updateDocSource",value:function(e){m.sendTraceTag(508420440,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy - call updateDocSource."),this.m_getPresInfoRequest?this.m_getPresInfoRequest.Source=e:m.sendTraceTag(508420439,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::updateDocSource - no valid m_getPresInfoRequest to update."),this.m_getItemsRequest?this.m_getItemsRequest.Source=e:m.sendTraceTag(508420438,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::updateDocSource - no valid m_getItemsRequest to update.")}},{key:"generateSnapDownloadUrlAsync",value:function(e,r){var t=this;return _async_to_generator((function(){var n,o,s,i,a,c,l,d;return _ts_generator(this,(function(f){switch(f.label){case 0:return f.trys.push([0,4,,5]),m.sendTraceTag(508420437,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::generateSnapDownloadUrlAsync - snapDownloadUrlRequest.ID: ".concat(e.ID,".")),(n=new Headers).append(u.ContentType,"application/json; charset=utf-8"),n.append(u.CallerCorrelationId,e.ID),r&&r.forEach((function(e,r){n.append(r,e)})),o="".concat(t.m_podsUrl,"/SnapUrlHandler.ashx"),s=new AbortController,i=setTimeout((function(){return s.abort()}),t.m_settings.timeout),[4,fetch(o,{headers:n,method:"POST",body:JSON.stringify(e),signal:s.signal}).catch(function(){var e=_async_to_generator((function(e){return _ts_generator(this,(function(r){return m.sendTraceTag(508420436,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:generateSnapDownloadUrlAsync - error when calling SnapUrlHandler : ".concat(e)),[2]}))}));return function(r){return e.apply(this,arguments)}}())];case 1:return a=f.sent(),clearTimeout(i),c="",a?[4,a.json()]:[3,3];case 2:l=f.sent(),m.sendTraceTag(508420435,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy:generateSnapDownloadUrlAsync - snapUrlResponse, FSuccess:".concat(l.FSuccess,", ErrorCode:").concat(l.ErrorCode)),l.FSuccess?c=l.SnapUrl:m.sendTraceTag(508420434,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:generateSnapDownloadUrlAsync - snap url failed with errorCode : ".concat(l.ErrorCode)),f.label=3;case 3:return[2,c];case 4:return d=f.sent(),m.sendTraceTag(508420433,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:generateSnapDownloadUrlAsync - exception: ".concat(d)),[2,""];case 5:return[2]}}))}))()}},{key:"setErrorMap",value:function(){for(var e=["cancelled","cancelado","キャンセルしました","Abgebrochen","취소됨","已取消","annulé","مُلغى","avbruten","отменено","annullato","zrušeno","poništeno","geannuleerd","ถูกยกเลิก","avbrutt","annulleret","скасовано","בוטל","đã huỷ","Kumottu","dibatalkan","vazgeçildi","anulat","anulowane","ακυρώθηκε","visszavonva"],r=0;r<e.length;r+=1)this.m_errorMap.set(e[r],c.ErrorRequestCanceled);for(var t=["The network connection was lost","Could not connect to the server","connection was lost","The internet connection appears to be offline","La conexión de red se perdió","ネットワーク接続が切れました","La connexion réseau a été perdue","Сетевое соединение потеряно","網路連線中斷","การเชื่อมต่อกับเครือข่ายหายไป","Зʼєднання з мережею втрачено","网络连接已中断","Nätverksanslutningen förlorades","A conexão de rede foi perdida","Ağ bağlantısı kesildi","Die Netzwerkverbindung wurde unterbrochen","La connessione è stata persa","A ligação à rede foi interrompida","Mistet nettverksforbindelsen","La conexión de red se ha perdido","網絡連線中斷","Đã mất kết nối mạng","Kehilangan jaringan koneksi","تم فقدان اتصال الشبكة","無法連接伺服器","네트워크 연결이 유실되었습니다","Verkkoyhteys katkesi","Netværksforbindelsen gik tabt","Bylo ztraceno připojení k síti","Połączenie sieciowe zostało utracone","A conexão à internet parece estar desativada","The Internet connection appears to be offline","La conexión a Internet parece estar desactivada","Could not connect to the server","De netwerkverbinding is verbroken","Conexiunea de rețea a fost pierdută","ネットワーク接続が切れました","החיבור לרשת אבד","NetworkError when attempting to fetch resource","无法连接服务器","No se ha podido establecer conexión con el servidor","Tidak dapat terhubung ke server","ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้","No se pudo establecer conexión con el servidor","A hálózati kapcsolat megszakadt"],n=0;n<t.length;n+=1)this.m_errorMap.set(t[n],c.ErrorConnectionLost);for(var o=["Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","No se pudo completar la operación. El software causó la anulación de la conexión","Không thể hoàn tất tác vụ. Phần mềm đã khiến kết nối bị hủy bỏ","تعذر إكمال العملية. ‏نتج عن البرنامج إيقاف الاتصال قبل اكتماله","Не удалось завершить операцию. Программа вызвала разрыв подключения","The operation couldn’t be completed. Software caused connection abort","Toimintoa ei voitu suorittaa. Ohjelmistosta johtuva yhteyden keskeytys","L’opération n’a pas pu s’achever. Interruption de la connexion due au logiciel","Operasi tidak dapat diselesaikan. Perangkat lunak menyebabkan pemutusan koneksi","No se pudo completar la operación. El software causó la anulación de la conexión","A operação não pôde ser concluída. O software provocou o cancelamento da conexão","No se ha podido completar la operación. El software ha causado la anulación de la conexión","Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","Der Vorgang konnte nicht abgeschlossen werden. Die Software hat einen Verbindungsabbruch verursacht","未能完成该操作。软件导致连接中止","無法完成作業。軟體導致連線失敗","無法完成操作。軟件導致連線失敗","ไม่สามารถดำเนินการให้เสร็จสิ้นได้ ซอฟต์แวร์เป็นสาเหตุให้ยกเลิกการเชื่อมต่อ","操作を完了できませんでした。ソフトウェアにより接続が中止されました","Postupak se nije mogao dovršiti. Softver je uzrokovao prekid veze","Åtgärden kunde inte slutföras. Program orsakade avbrott i anslutningen","İşlem tamamlanamadı. Yazılım bağlantının kesilmesine neden oldu","Не вдалося завершити операцію. Програма обірвала звʼязок"],s=0;s<o.length;s+=1)this.m_errorMap.set(o[s],c.ErrorSoftwareConnectionAbort);for(var i=["The request timed out","要求がタイムアウトになりました","La requête a expiré","要求がタイムアウトになりました","Se agotó el tiempo de espera","Esgotou-se o tempo limite da solicitação","请求超时"],a=0;a<i.length;a+=1)this.m_errorMap.set(i[a],c.ErrorRequestTimeout);for(var u=["cannot parse response","impossible d’analyser la réponse","无法解析响应"],l=0;l<u.length;l+=1)this.m_errorMap.set(u[l],c.ErrorCannotParseResponse);this.m_errorMap.set("The operation was aborted",c.ErrorRequestAbort),this.m_errorMap.set("Failed to fetch",c.ErrorFailedToFetch),this.m_errorMap.set(404,c.ErrorRequestFailedServerNotFound),this.m_errorMap.set(502,c.ErrorRequestFailedBadGateway),this.m_errorMap.set(503,c.ErrorRequestFailedServiceUnavailable),this.m_errorMap.set(504,c.ErrorRequestFailedGatewayTimeout)}},{key:"getMappedError",value:function(r){var t=r;return(t=e.trimErrorName(t,["TypeError:","Loading failed:"])).indexOf("Bylo ztraceno")>=0?c.ErrorConnectionLost:t.indexOf("AbortError:")>=0?c.ErrorRequestAbort:this.m_errorMap.get(t)}},{key:"parseMultipartResponseAsync",value:function(r,t,s){var i=this;return _async_to_generator((function(){var a,d,f,_,h,v,g,w,b,C,P,E,x,O,A,T,k,M,R,j,N,W,F,D,U,L,H,J,q,B,G,z,V,K,X,$,Y,Q,Z,ee;return _ts_generator(this,(function(re){switch(re.label){case 0:if(a={},d={itemErrorCodeMap:new Map,itemErrorCategoryMap:new Map,itemUsedOutputCacheMap:new Map,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,data:void 0},f={slideOrder:[],slideAllInfo:[]},t[u.firstResponseCheck]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},!(r.response&&r.response.body&&r.response.headers&&r.response.headers.get(u.ContentType)))return[3,12];_=r.response,h="";try{t[u.fetchBoundary]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},h=i.m_multipartParser.fetchBoundary(_.headers.get(u.ContentType)),t[u.fetchBoundary].end=e.performanceNowTrimmed()}catch(e){return v=_.headers.get(u.ErrorCode),g=_.headers.get(u.ErrorCategory),w=!!r[u.IsIntentional]&&r[u.IsIntentional],b=_.headers.get(u.XCorrelationId),m.sendTraceTag(508420432,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::parseMultipartResponse - fetchBoundary Content-Type header: ".concat(_.headers.get(u.ContentType),", ErrorCode:").concat(v,", ErrorCategory:").concat(g,", IsIntentional:").concat(w," , Correlation:").concat(b,", Exception:").concat(e)),d.responseErrorCode=v||c.ErrorRequestFailed,d.responseErrorCategory=g||l.BadRequest,[2,d]}return C=e.performanceNowTrimmed(),t[u.downloadResponse]={start:C,end:C},m.sendTraceTag(508420431,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::parseMultipartResponse - download response stream start: ".concat(C)),s&&s.requestType===n.getItemsPresInfoAndSlideInfoAsync&&i.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.DownloadResponseStream}),P=!1,E=void 0,x=null,A=_.headers?_.headers.get(u.ContentLength):-1,T=-1,m.sendTraceTag(508420430,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy:shouldUseResponseStreamWhenReceivedTotalLength: ".concat(i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength)),i.m_settings.parsingWhileDownloadingEnabled?(k=!1,M=!1,R=function(r){k=!0,M=r;var a={receivedDataLength:T,responseContentLength:A,duration:e.performanceNowTrimmed()-C,downloadFailed:M};m.sendTraceTag(508420429,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy - return from response stream reading. ".concat(JSON.stringify(a)));var c=e.performanceNowTrimmed();m.sendTraceTag(508420428,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::parseMultipartResponse - download response stream end: ".concat(c,", duration: ").concat(c-C)),t[u.downloadResponse].end=c,t[u.downloadResponse].length=T,!P&&s&&s.requestType===n.getItemsPresInfoAndSlideInfoAsync&&i.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.ParseMultipartResponse})},T=0,j=_.body,N=_sliced_to_array(j.tee(),2),W=N[0],F=N[1],D=new Promise(function(){var e=_async_to_generator((function(e){var r,t,n,o,s,i;return _ts_generator(this,(function(a){switch(a.label){case 0:a.trys.push([0,4,,5]),r=I.readNumberOrDefault("hackMaxBytes",-1),t=W.getReader(),a.label=1;case 1:return[4,t.read()];case 2:if(n=a.sent(),o=n.done,s=n.value,o)return R(!1),e(),[3,3];if(s&&(T+=s.length,r>0&&T>r))throw"hackMaxBytes hit";return[3,1];case 3:return[3,5];case 4:return i=a.sent(),m.sendTraceTag(508420427,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::measuringDownloadPromise - exception ".concat(i,".")),R(!0),e(),[3,5];case 5:return[2]}}))}));return function(r){return e.apply(this,arguments)}}()),s&&s.shouldTimeoutResponseStreamDownload&&(L=s&&s.overrideDownloadTimeoutMs?s.overrideDownloadTimeoutMs:i.m_settings.responseStreamDownloadTimeout?i.m_settings.responseStreamDownloadTimeout:3e4,U=window.setTimeout((function(){k||(P=!0,m.sendTraceTag(508420426,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),m.sendTraceTag(508420425,p.msoulscat_Wac_PptSession,y.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),W.cancel(),F.cancel())}),L)),H=new S(i.m_settings,a,t,d),J=i.m_multipartParser.processMultipartBinaryResponse(F.getReader(),h,(function(e){H.parsePart(e)})),[4,Promise.all([D,J])]):[3,2];case 1:if(re.sent(),M)return d.responseErrorCode=c.ErrorRequestFailed,d.responseErrorCategory=l.Transient,d.data=void 0,[2,d];if(s&&s.shouldTimeoutResponseStreamDownload&&(clearTimeout(U),m.sendTraceTag(508420424,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy - response download check. ".concat(JSON.stringify({hasTimeout:P,shouldUseResponseStreamWhenReceivedTotalLength:i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:T,responseContentLength:A})))),P){if(!(i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&A>0&&T>0&&A===T))return d.responseErrorCode=c.ErrorDownloadResponseStreamTimeout,[2,d];m.sendTraceTag(508420423,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens")}return f=H.parsedResponse,[3,11];case 2:return s&&s.shouldTimeoutResponseStreamDownload?(q=s&&s.overrideDownloadTimeoutMs?s.overrideDownloadTimeoutMs:i.m_settings.responseStreamDownloadTimeout?i.m_settings.responseStreamDownloadTimeout:3e4,B="downloadResponseStreamTimeout",z=new Promise((function(e){E=setTimeout((function(){m.sendTraceTag(508420422,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),G&&(m.sendTraceTag(508420421,p.msoulscat_Wac_PptSession,y.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),G.cancel()),e(B)}),q)})),G=_.body.getReader(),(x=i.readResponseStream(G,A)).then((function(r){var t={receivedDataLength:T=r&&r.length||-1,responseContentLength:A,duration:e.performanceNowTrimmed()-C};m.sendTraceTag(508420420,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy - return from response stream reading. ".concat(JSON.stringify(t)))})),[4,Promise.race([x,z])]):[3,4];case 3:return(O=re.sent())===B?P=!0:void 0!==E&&clearTimeout(E),[3,6];case 4:return V=Uint8Array.bind,[4,_.arrayBuffer()];case 5:O=new(V.apply(Uint8Array,[void 0,re.sent()])),(K=I.readNumberOrDefault("hackMaxBytes",-1))>0&&O.length>K&&(O=O.slice(0,K)),re.label=6;case 6:return s&&s.shouldTimeoutResponseStreamDownload&&m.sendTraceTag(508420419,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy - response download check. ".concat(JSON.stringify({hasTimeout:P,shouldUseResponseStreamWhenReceivedTotalLength:i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:T,responseContentLength:A}))),P?i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&x&&A>0&&T>0&&A===T?(m.sendTraceTag(508420418,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),[4,x]):[3,8]:[3,9];case 7:return O=re.sent(),[3,9];case 8:return d.responseErrorCode=c.ErrorDownloadResponseStreamTimeout,[2,d];case 9:return X=e.performanceNowTrimmed(),m.sendTraceTag(508420417,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::parseMultipartResponse - download response stream end: ".concat(X,", duration: ").concat(X-C)),$=O,t[u.downloadResponse].end=X,$&&$.length&&(t[u.downloadResponse].length=$.length),s&&s.requestType===n.getItemsPresInfoAndSlideInfoAsync&&i.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.ParseMultipartResponse}),Y=new S(i.m_settings,a,t,d),[4,i.m_multipartParser.processMultipartBinaryResponse($,h,(function(e){Y.parsePart(e)}))];case 10:re.sent(),f=Y.parsedResponse,re.label=11;case 11:return[3,13];case 12:Q=r.hasOwnProperty(u.errorCode)&&r[u.errorCode]!==c.ErrorRESERVEDSuccess?r[u.errorCode]:c.ErrorRequestFailed,Z=r[u.errorCategory]?r[u.errorCategory]:l.BadRequest,ee=!!r[u.IsIntentional]&&r[u.IsIntentional],d.responseErrorCode=Q,d.responseErrorCategory=Z,m.sendTraceTag(508420416,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::parseMultipartResponse - responseErrorCode:".concat(Q,", responseErrorCategory:").concat(Z,", IsIntentional:").concat(ee)),re.label=13;case 13:for(var te in t[u.firstResponseCheck].end=e.performanceNowTrimmed(),d.responseErrorCode!==c.ErrorRESERVEDSuccess&&d.responseErrorCategory===l.ErrorRESERVEDSuccess&&(d.responseErrorCategory=l.BadRequest,m.sendTraceTag(508420387,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::parseMultipartResponse - parsedResponse contains errorCode but no errorCategory. responseErrorCode:".concat(d.responseErrorCode))),a)f.slideAllInfo.push({ID:a[te].ID,SlideImageData:a[te].SlideImageData,SlideShowInfo:a[te].SlideShowInfo,Title:a[te].Title,NoteHtml:a[te].NoteHtml,Comments:a[te].Comments,HasAnimation:a[te].HasAnimation,Hidden:a[te].Hidden,HasTransition:a[te].HasTransition,ResourceData:a[te].ResourceData,AccessibilityModel:a[te].AccessibilityModel,MediaUrls:a[te].MediaUrls});try{if(I.readBooleanOrDefault("shouldUpdateNewFileUrlFromSnapTrailerItem",!1)&&(d.itemErrorCodeMap&&Object.values(d.itemErrorCodeMap).includes(c.ServerErrorFileDownloadResourceInconsistent)||d.newSnapUrl)){if(d.newSnapUrl)return 0===d.itemErrorCodeMap.size&&m.sendTraceTag(508420386,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:got new snap url without errorcode"),m.sendTraceTag(508420385,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy:getItems get valid new file url"),i.events.emit("downloadUrlChanged",d.newSnapUrl),[2,d];m.sendTraceTag(508420384,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){m.sendTraceTag(508420383,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return d.data=f,[2,d]}}))}))()}},{key:"readResponseStream",value:function(e,r){var t=this;return _async_to_generator((function(){var n,o,s,i;return _ts_generator(this,(function(a){switch(a.label){case 0:n=new Uint8Array(0),a.label=1;case 1:return a.trys.push([1,6,,7]),[4,e.read()];case 2:o=a.sent(),a.label=3;case 3:if(o.done)return[3,5];if(n=new Uint8Array(_to_consumable_array(n).concat(_to_consumable_array(o.value))),(s=I.readNumberOrDefault("hackMaxBytes",-1))>0&&n.length>s)throw n=n.slice(0,s),"hackMaxBytes hit";return r>0&&n.length===r&&(m.sendTraceTag(508420382,p.msoulscat_Wac_PptSession,y.Info,"PodsProxy::readResponseStream - received length reached content length: ".concat(r)),t.m_settings.shouldUseResponseStreamWhenReceivedTotalLength)?[3,5]:[4,e.read()];case 4:return o=a.sent(),[3,3];case 5:return[3,7];case 6:return i=a.sent(),m.sendTraceTag(508420381,p.msoulscat_Wac_PptSession,y.Error,"PodsProxy::readResponseStream - exception ".concat(i,".")),[2,new Uint8Array(0)];case 7:return[2,n]}}))}))()}},{key:"generateReportPerfDictionary",value:function(e){var r={};return e[u.action]&&(r[u.action]=e[u.action]),e[u.correlationId]&&(r[u.correlationId]=e[u.correlationId]),e[u.server]&&(r[u.server]=e[u.server]),e[u.parser]&&(r[u.parser]=e[u.parser]),e[u.downloadResponse]&&(r[u.downloadResponse]=e[u.downloadResponse]),e[u.usedOutputCache]&&(r[u.usedOutputCache]=e[u.usedOutputCache]),e[u.contentLength]&&(r[u.contentLength]=e[u.contentLength]),r}},{key:"createPresInfoAndSlideInfoResponse",value:function(r,t){var n=(c.ErrorRESERVEDSuccess,l.ErrorRESERVEDSuccess);return t[u.createResponse]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},n={itemErrorCodeMap:r.itemErrorCodeMap,itemErrorCategoryMap:r.itemErrorCategoryMap,responseErrorCode:r.responseErrorCode,responseErrorCategory:r.responseErrorCategory,responseIsIntentional:!1,presInfo:r.data&&r.data.slideAllInfo&&r.data.slideAllInfo.length>0?r.data.slideAllInfo[0]:void 0,slideInfo:r.data&&r.data.slideAllInfo?r.data.slideAllInfo.slice(1):[],usedOutputCache:r.usedOutputCache,itemUsedOutputCacheMap:r.itemUsedOutputCacheMap},t[u.createResponse].end=e.performanceNowTrimmed(),n}},{key:"createSlideInfoResponse",value:function(r,t){var n=this;return _async_to_generator((function(){var o;return _ts_generator(this,(function(s){switch(s.label){case 0:return o={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[]},t[u.createResponse]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},[4,r.then((function(e){n.m_settings.shouldFixSlideDataOrder&&n.fixSlideImageDataOrder(e),o={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return s.sent(),t[u.createResponse].end=e.performanceNowTrimmed(),[2,o]}}))}))()}},{key:"fixSlideImageDataOrder",value:function(e){e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.forEach((function(e){if(e&&e.ResourceData&&e.SlideShowInfo&&e.SlideShowInfo.sld){var r=new Map(e.ResourceData.map((function(e){return[e.Id,e.Base64]})));e.SlideShowInfo.sld.forEach((function(e){e.resCat.forEach((function(e){r.has(e.id)&&""===e.base64&&(e.base64=r.get(e.id))}))}))}}))}},{key:"createSlideIdResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"createPresInfoResponse",value:function(e){var r=this;return _async_to_generator((function(){var t;return _ts_generator(this,(function(n){switch(n.label){case 0:return t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,presInfo:void 0},[4,e.then((function(e){r.m_settings.shouldFixSlideDataOrder&&r.fixHiddenSlideOrder(e),t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return n.sent(),[2,t]}}))}))()}},{key:"fixHiddenSlideOrder",value:function(e){e.data.slideAllInfo[0].HiddenSlideOrder=e.data.slideAllInfo[0].HiddenSlideOrder?e.data.slideAllInfo[0].HiddenSlideOrder:[]}},{key:"createSlideOrderAndSlidesInfoIndexResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:l.ErrorRESERVEDSuccess,responseErrorCode:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"createPresInfoAndSlideInfoIndexResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:l.ErrorRESERVEDSuccess,responseErrorCode:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0].SlideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo.slice(1):[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"setTimeoutForParsingResponse",value:function(e){return window.setTimeout((function(){m.sendTraceTag(508420380,p.msoulscat_Wac_PptSession,y.Warning,"Parsing didn't finish in the time. ".concat(JSON.stringify(e)))}),this.m_settings&&this.m_settings.parseResponseTimeout?this.m_settings.parseResponseTimeout:25e3)}},{key:"objectDictionaryToRequestIdString",value:function(e){var r="";for(var t in e)e[t]&&(r="".concat(r).concat(t,"=").concat(e[t],";"));return r}}],[{key:"getFieldFromReponseHeader",value:function(e,r){return e.headers?e.headers.get(r):u.unknown}},{key:"trimErrorName",value:function(e,r){for(var t=e,n=0;n<r.length;n+=1)t.lastIndexOf(r[n])>=0&&(t=t.substring(t.lastIndexOf(r[n])+r[n].length));return t?t.trim():""}},{key:"convertServerError",value:function(e,r){return r&&e&&""!==e.trim()&&e!==u.unknown?"Server".concat(e):c.ErrorRequestFailed}},{key:"logPerf",value:function(e){}},{key:"ensureISlideInfoFilters",value:function(e){return e&&void 0!==e.EnableClustering?e:{EnableClustering:!1,ExportAsImages:!1}}},{key:"performanceNowTrimmed",value:function(){return Math.round(performance.now())}},{key:"logPerformanceEntries",value:function(e,r){var t=e.getEntriesByType("resource"),n={},o=!0,s=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;if("fetch"===c.initiatorType){var l=!1,d=!0,f=!1,_=void 0;try{for(var v,g=r[Symbol.iterator]();!(d=(v=g.next()).done);d=!0){var S=v.value;if(c.name.indexOf(S)>0||c.name.startsWith(S)){l=!0;break}}}catch(e){f=!0,_=e}finally{try{d||null==g.return||g.return()}finally{if(f)throw _}}if(l){if(n.name=c.name,n.dateTime=performance.now(),h.ChangeGate.isChangeGateEnabled("PodsProxy.recordPerfTimingUrlParts")){var I=new URL(c.name);n.hostname=I.hostname,n.pathname=I.pathname}n.start=c.startTime,n.redirectStart=c.redirectStart,n.redirectEnd=c.redirectEnd,n.domainLookupStart=c.domainLookupStart,n.domainLookupEnd=c.domainLookupEnd,n.tcpHandshakeStart=c.connectStart,n.tcpHandshakeEnd=c.connectEnd,n.secureConnectionStart=c.secureConnectionStart,n.responseStart=c.responseStart,n.responseEnd=c.responseEnd,n.fetchStart=c.fetchStart,n.requestStart=c.requestStart,"decodedBodySize"in c&&(n.decodedBodySize=c.decodedBodySize),"encodedBodySize"in c&&(n.encodedBodySize=c.encodedBodySize),"transferSize"in c&&(n.transferSize=c.transferSize),Object.keys(n).length>0&&m.sendTraceTag(572379986,p.msoulscat_Wac_PptSession,y.Info,"".concat(JSON.stringify(n)))}}}}catch(e){s=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw i}}}}]),e}();return C.s_events=new g.EventEmitter,C.s_supportedImageType=[f.ImagePng,f.ImageJpg],s}()}));
//# sourceMappingURL=PodsProxy.js.map